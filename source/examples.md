# Examples

## Example. Build bag with dbGap study guide ID

If a value is assigned to `dbgap_study_id`, then that value is assigned to the column `dbgap_study_id` for all `fast.gz` files.

```
import hubmapbags
from datetime import datetime
from pathlib import Path

output_directory = 'cfdebdbags-' + datetime.today().strftime('%Y%m%d')
if not Path(output_directory).exists():
    Path(output_directory).mkdir(parents=True, exist_ok=True)

id = 'HBM666.FFFW.363'
dbgap_study_id = 'phs002267' #dbGaP study id

hubmapbags.magic.do_it( id, \
    overwrite=False, \ #if local file is present, do not overwrite
    dbgap_study_id=dbgap_study_id, \
    compute_uuids=False, \ #do not compute uuids
    copy_output_to = output_directory, \
    instance='prod', \
    debug=True )
```

## Example. Skip checksum computation if local file is found

This functionality is useful when computing checksums using SLURM rather than AirFlow

```
import hubmapbags
from datetime import datetime
from pathlib import Path

output_directory = 'cfdebdbags-' + datetime.today().strftime('%Y%m%d')
if not Path(output_directory).exists():
    Path(output_directory).mkdir(parents=True, exist_ok=True)

id = 'HBM666.FFFW.363'
dbgap_study_id = 'phs002267'

hubmapbags.magic.do_it( id, \
    overwrite=True, \ #it erases local file and recomputes checksums
    dbgap_study_id=dbgap_study_id, \
    compute_uuids=True, \ #generate uuids
    copy_output_to = output_directory, \
    instance='prod', \
    debug=True )
```

## Example. Build bags with dbGap info

Generally speaking a dbGaP study guide is assigned to multiple datasets. 

```
import hubmapbags
from datetime import datetime
from pathlib import Path

output_directory = '/hive/hubmap-test/bdbags/2022.2'
if not Path(output_directory).exists():
    Path(output_directory).mkdir(parents=True, exist_ok=True)

ids=['HBM788.KHPF.569','HBM434.VLFT.986', \
	'HBM965.GZHL.485','HBM552.MSWZ.288', \
	'HBM384.XXGK.466','HBM676.SNSW.596', \
	'HBM766.XTBC.899','HBM682.TWTR.428', \
	'HBM376.FRWD.797']

# token generated by accessing HuBMAP
token='<this-is-my-token>'

for id in ids:
	hubmapbags.magic.do_it( id, \
        overwrite=True, \ #will re-compute checksums even if local file is present
		dbgap_study_id=None, \
		token=token, \
        	compute_uuids=True, \ #will compute uuids unless it finds ids in the uuid-api database
        	copy_output_to = output_directory, \
        	instance='prod', \
        	debug=True )
```

## Example. Get UUIDs saved in the uuid-api
```
import hubmapbags

id = 'HBM666.FFFW.363'
token = '<this-is-my-token>'
instance = 'prod' #default instance is test

uuids = hubmapbags.uuids.get_uuids( id, token=token, instance=instance )
print(uuids)
```

## Example. Generate UUIDs
```
import hubmapbags

id = 'HBM666.FFFW.363'
token='<this-is-my-token>'

answer = hubmapbags.uuids.populate_local_file_with_remote_uuids( id, instance='prod', token=token, debug=True )
```